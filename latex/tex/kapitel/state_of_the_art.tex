\chapter{State of the art}



\section{Videospiel-Markt}

Videospiele sind Bestandteil des Medienkonsums in Deutschland. Rund 6 von 10 Menschen in Deutschland spielen Computer- und Videospiele. Der deutsche Videospiel-Markt machte mit Videospiel-Hardware, Videospiel-Abo-Diensten und Videospielen im Jahr 2023 einen Umsatz von 9,97 Milliarden Euro. Dabei machten Videospiele und In-Game Käufe mit 5,845 Milliarden Euro einen Umsatz von ca. 59\% aus. Im Vorjahr 2022 entstand ein Umsatz von 9,432 Milliarden Euro, somit stieg der Umsatz von 2022 im Jahr 2023 um 6\%.  Zahlen für das Jahr 2024 sind noch nicht bekannt.

\begin{figure}[h]
  \centering
  \includegraphics[width=15cm]{state_of_the_art/deutscher_vs_markt}
	\captionsetup{justification=justified, format=plain}
  \caption{Wachstum des deutschen Videospielmarkts über die Jahre}
  \label{Deutscher Videospielmarkt}
\end{figure}

Auf der erfolgreichen Computerspiel Vertriebsplattform Steam von Valve wurden vergangenes Jahr 2023 14.324 Computerspiele veröffentlicht. Seit 2019 wächst die Veröffentlichung der Computerspiele auf Steam stetig.

\begin{figure}[h]
  \centering
  \includegraphics[width=15cm]{state_of_the_art/steam_veroffentlichungen}
	\captionsetup{justification=justified, format=plain}
  \caption{Computerspiel Veröffentlichungen auf Steam über die Jahre}
  \label{SteamDB Statistik}
\end{figure}

Folglich kann davon ausgegangen werden, dass es Stakeholder gibt, die sich für Videospiele interessieren.



\section{Game-Engines}

Seit der Doom-Engine sind neue Game-Engines entstanden und haben sich weiterentwickelt.

\subsection{Godot}

Godot ist die Game-Engine auf der die Implementierung umgesetzt wurde.

\subsubsection{Investitionen}

Godot ist für größere Unternehmen interessant. So hat \textit{Microsoft} 2017 eine \$24.000 Spende an Godot getätigt, da C# mit Godot kompatibel wurde. Der Spieleentwickler \textit{Epic Games} hat 2020 eine \$250.000 Spende getätigt, da Epic Games OpenSource Projekte fördert, welche 3D-Grafik Umgebungen weiterentwickeln.\autocite{megagrant} Man beachte, dass Epic Games selbst die Unreal Engine entwickelt und eigentlich ein Konkurrent ist. Im Jahr 2020 und 2021 hat \textit{Meta} an Godot gespendet, damit diese die XR Umgebung für Godot entwickeln. Auch \textit{Khronos Group} möchte die XR Umgebung weiterentwickeln und unterstützt Godot aufgrund der Integration von \textit{OpenXR} \autocite{khronos}. Entwicklerstudios selbst spenden ebenfalls an Godot. So hat das Entwicklerstudio \textit{Re-Logic} eine \$100.000 Spende im Jahr 2023 getätigt.\autocite{gdfd2023}

Weitere Investoren kann man auf der Webseite von Godot einsehen.\footnote{https://godotengine.org/} Folglich kann ein Trend an Investoren für Godot erkannt werden und somit auch die Relevanz von Godot als Game-Engine.

\subsubsection{Relevanz}

Godots Relevanz ist in den letzten Jahren gestiegen. Godot wird mit der Unity Engine verglichen, welche gerne von Indie-Entwicklerstudios benutzt wird. 

\subsection{Unity}

Unitys Versuch, ein neues Gebührenmodell für Entwickler einzuführen, hat die Wahrnehmung der Game-Engine als entwickler-freundliches Programm negativ beeinflusst. So kündigte Unity Semptember 2023 eine Änderung des Gebührenmodells, zum Anfang des Jahres 2024, an. Die neue Regelung sah vor, dass Entwickler ab einem Umsatz von 200.000 US-Dollar und mindestens 200.000 Installationen für jede Erstinstallation eines Spiels 20 US-Cent an Unity zahlen sollten.

Die Änderung hätte finanzielle Folgen für viele Entwicklersutdios, insbesondere für Indieentwickler. So berichtete eine Indiestudio für Mobile-Games, dass diese rund 108 Prozent ihrer Bruttoeinnahmen abführen müssen. Weitere Videospielentwickler sprachen davon, dass Unity sie in den Bankrott treiben würden. Das Entwicklerstudio Mega Crit kündigte an eines ihrer erfolgreichen Videospiele zu entfernen. Andere Videospielentwickler kündigten an zur Konkurrenz von Unity zu wechseln. So hat das Entwicklerstudio Mega Crit angeküdnigt, ihre Projekt auf eine andere Engine umzustellen, obwohl sie bereits seit Jahren mit Unity arbeiteten.



https://www.golem.de/news/gaming-unity-moechte-108-prozent-unserer-einnahmen-2309-177656.html: (14. Sep 2023)
%Unity wollte am 09.2023 zum 01.2024 ihr Lizenzmodell ändern. 
%Diese Änderung hat Alarm bei der Spielebranche ausgelöst.
%Vor allem die Hersteller von Mobile Games machen sich Sorgen um ihre Zukunft.
%Anonymes Entwicklerstudio: Wenn die neuen Kosten von Unity bereits 2022 gegolten hätten, hätte man rund 108 Prozent seiner Bruttoeinnahmen abführen müssen.
%Spieleentwickler Rami Ismail: Unity sei mit den neuen Regeln das "einzige Geschäftsmodell, das einen in den Bankrott treiben kann".
%Einige Entwickler wollen zur Technik von Konkurrenten wechseln – hier dürfte vor allem die Unreal Engine zum Gewinner werden.
%Studio Mega Crit (Slay the Spire) kündigte an, dass es wegen des neuen Lizenzmodells die Engine für sein nächstes Projekt umstellen werde, obwohl es seit über zwei Jahren an dem nicht angekündigten Titel arbeitet.
%Entwicklerstudio Massive Monster meldet, sein erfolgreiches Indiegame Cult of the Lamb am 1. Januar 2024 wegen des dann gültigen Lizenzmodells löschen zu wollen
%Für jede Erstinstallation eines Spiels, das auf der Engine von Unity basiert, durch den Endkunden müssen Entwickler 20 US-Cent an Unity bezahlen. Das gilt ab einem Umsatz von 200.000 US-Dollar und ab mindestens 200.000 Installationen.

https://www.golem.de/news/neues-lizenzmodell-unity-entschuldigt-sich-fuer-verwirrung-und-veraergerung-2309-177723.html (18. Sep 2023)
Nachdem der Engine-Entwickler Unity die Spielebranche in der vergangenen Woche mit der Ankündigung eines neuen Lizenzmodells in Aufruhr versetzt hat, rudert das Unternehmen nun zurück.

https://www.golem.de/news/spiele-engine-unity-macht-kehrtwende-bei-bezahlmodell-2309-177915.html (23. September 2023)
Unity macht Kehrtwende bei Bezahlmodell
Nach massiver Kritik ändert Unity sein ursprünglich geplantes neues Bezahlmodell und nimmt viele Änderungen zurück.
Doch trotz der angekündigten und nun umgesetzten Kehrtwende sprechen viele Entwickler immer noch von einem Vertrauensverlust. Das Terraria-Team warf Unity gar "räuberische Machenschaften" vor.

https://www.golem.de/news/spieleindustrie-unity-oder-godot-wer-gewinnt-das-engine-duell-2310-178099.html (4. Oktober 2023)
Unitys undurchsichtige Preispolitik hat Kunden nachhaltig verschreckt. Ein Open-Source-Projekt schickt sich nun an, der Profi-Engine Konkurrenz zu machen.
Unity, die Firma hinter der laut Schätzungen von SteamDB mit knapp 40.000 Titeln meistgenutzten Engine im wichtigsten Shop für PC-Games
Derzeit besonders im Kommen: Godot, ein Open-Source-Projekt mit flexibler Scripting-Unterstützung und ähnlichem Baukastenprinzip wie Unity, in der Vergangenheit vor allem spezialisiert auf schlanke 2D-Projekte.
Durch die zusätzliche Ansprache des .Net-Frameworks kann das bei leistungshungrigen Anwendungen in manchen Fällen zu Performance-Einbußen führen. Dafür ist C# beispielsweise aufgrund automatisierter Speicherverwaltung einsteigerfreundlicher, Stichwort garbage collector.
Speicherlecks werden dadurch vermieden. Übrigens: Per Reference Counting ist die Speicheroptimierung auch in Godots hauseigener Skriptsprache gegeben.
Der große Vorteil von Godot: Anders als bei Unity kommt hier die Frage nach Gebühren und Umsatzbeteiligungen gar nicht erst auf. Godot ist ein klassisches Open-Source-Projekt und wird von der Community erweitert, die Projektleitung liegt bei den Entwicklern und Gründern Juan Linietsky und Ariel Manzur.
Lizensiert ist Godot unter der MIT-Lizenz, heißt: Anders als beim proprietären Unity kann die Engine zu jedem Zweck genutzt, bearbeitet und weitervertrieben werden. Die Finanzierung des Projects findet also nicht über monatliche und erfolgsabhängige Gebühren statt, sondern hauptsächlich über den Godot Development Fund, in den knapp 1.500 Mitglieder derzeit zusammen etwa 50.000 Euro pro Monat einzahlen.

https://www.golem.de/news/john-riccitiello-umtrittener-unity-chef-tritt-mit-sofortiger-wirkung-zurueck-2310-178342.html (10.Oktober 2023)
Riccitiello war schon vorher umstritten, Spieleentwickler vulgär zu beleidigen
Umtrittener Unity-Chef tritt mit sofortiger Wirkung zurück

https://unity.com/de/blog/unity-is-canceling-the-runtime-fee (12 Sept 2024)
Unity verwirft die Runtime-Gebühr
Wir kehren also zu unserem alten, platzbasierten Abonnementmodell für alle Spielekunden zurück

\subsection{Unreal-Engine}



\section{Entscheidungssysteme in der Game AI}

In der Funktionalität von Entscheidungssystemen wie Behavior Trees (BT), Finite State Machines (FSM) und Goal-Oriented Action Planning (GOAP) wurde bereits eingehend auf deren Grundlagen eingegangen. Das folgende Kapitel widmet sich nun der praktischen Anwendung dieser drei Systeme sowie fortschrittlicher Methoden des maschinellen Lernens in der modernen Videospielentwicklung und Forschung.

Es muss angemerkt werden, dass es nicht das eine beste Entscheidungssystem gibt. Im Grundlagenkapitel Game-AI wurde bereits erläutert, dass es abseits der Entscheidungssysteme weitere Komponenten gibt, welche die Immersion des NPC beeinflussen. Faktoren wie die Aktionen, die ein NPC ausführt, die Wahrnehmung der Spielwelt durch den NPC oder die Navigation zu einer bestimmten Koordinate tragen zur Immersion bei. Ein Entscheidungssystem soll dabei logische Aktionen des NPC in seinem derzeitigen Zustand wählen. Je nachvollziehbarer diese Aktionen sind, desto stärker ist die Immersion.

Videospielentwickler verwenden für ihre NPCs oft nicht nur ein einzelnes Entscheidungssystem. So nutzten die Videospielentwickler des Action-Rollenspiel \textit{Final Fantasy XV (2016)} ein Entscheidungssystem, das sowohl BTs als auch FSMs integriert \textit{(AI Graph Editor)}. Dies zeigt, dass die Kombination mehrerer Entscheidungssysteme eine sinnvolle Alternative darstellen kann.

So werden in Foren bis heute diskutiert, welche Videospiele mit ihrer Game-AI hervorstechen. Besonders werden Videospiele gelobt, welche GOAP als Entscheidungssystem umgesetzt haben. Zu diesen Spielen gehören unter anderem \textit{F.E.A.R. (2005)} und \textit{S.T.A.L.K.E.R. (2007)}.
In Online Artikeln wie \autocite{vanceai}, \autocite{techopedia} und \autocite{gamerant} werden beide Titel weiterhin als Beispiele für herausragende Game-AI genannt. Sie stehen trotz ihren Alters dabei in einer Reihe mit aktuelleren Spielen, wie \textit{Alien Isolation (2014)} oder \textit{The Last of Us (2013)}.
Angemerkt sein noch, dass es schwierig zu sagen ist, welche Entscheidungssysteme aktuell in Videospielen eingesetzt werden. Videospieleentwickler geben selten detaillierte Informationen über die von ihnen verwendeten Entscheidungssysteme. Die Tabelle X soll dabei einige bekanntere Videospiele und ihre Entscheidungssysteme darstellen.


\subsection{Fortschrittliche Methoden des maschinellen Lernens}

Der Trend von fortschrittliche Methoden des maschinellen Lernens, hat an Bedeutung gewonnen. Die Methoden spielen zwar eine immer größere Rolle im alltäglichen Leben, haben jedoch einen eher geringeren Einfluss im Bereich der Game AI. Diese Methoden erfordern große Mengen an Daten für das Training und es ist äußerst schwierig, sie auf unvorhergesehene Situationen, wie in Videospielen, zu testen. \autocite{U2023}

Es existieren wenige veröffentlichten Studien, die ihre Anwendung als Entscheidungssystem für NPC dokumentieren, \autocite{U2023} daher werden diese nicht weit erläutert. Dennoch gibt es Videospiele, welche diese Methoden für bestimmte Funktionen von NPC verwendet werden und in den folgenden Abschnitten erläutert werden. Es wäre interessant diese Methoden ausführlicher in der akademischen Forschung Richtung Game AI zu sehen, insbesondere in Richtung Entscheidungssysteme.

Die Methoden des maschinellen Lernens kann man in supervised learning (SL), unsupervised learning (UL) und reinforcment learning(RL) unterteilen. So bekommt SL gelabelte Daten und UL Rohdaten mit denen sie trainieren. Während RL auf Basis der Umgebung lernt und durch richtige Aktionen belohnt wird. So wird Deep Learning, ein Teil von SL, für Spracherkennung und natural language processing benutzt. Im Strategiespiel StarCraft wird RL für das \textit{micromanagement} der NPC benutzt. \autocite{inbook}

Die Evolutionäre-Algorithmen sind inspiriert durch Darwins Theorie der Evolution. Sie optimieren dabei eine Population, wo jedes Individuum eine Lösung repräsentiert und mit einer Fitness-Wert gekennzeichnet ist. Durch Iterationen finden Selektionen und Mutationen in der Population statt, welche den Fitness-Wert der optimalen Lösung erhöhen. Im Bereich der Videospielentwicklung optimierte der Algorithmus beispielsweise die Baureihenfolge der NPC im Strategiespiel StarCraft. \autocite{inbook}


\subsection{Finite State Machines}

In den frühen Tagen der Spielentwicklung waren FSM ausreichend, um eine Entscheidungsfindung für NPC bereitzustellen. So wurde bereits im Grundlagenkapitel das Videospiel \textit{Half-Life (1998)} erwähnt. Auch abseits des FPS-Genre wurde die FSM verwendet. 2D-Videospiele wie Pac-Man und Sonic nutzten FSM, um das Verhalten ihrer NPC zu definieren. \autocite{U2023}

Die Umsetzung einer FSM wird oft als Einstieg in die Entscheidungssysteme der Game-AI empfohlen. Sie sind die am häufigsten verwendete Methode zur Entscheidungsfindung, bei NPC mit geringer Komplexität. Bis heute machen sie den Großteil der in Spielen eingesetzten Entscheidungssysteme aus \autocite{AIgames}.

Bei komplexen Videospielen wird öfter eine Hierarchical State Machine (HFSM) umgesetzt. Es handelt sich dabei um eine Erweiterung der FSM. Eine HFSM bietet im Gegensatz zur FSM die Möglichkeit, Zustände zu verschachteln und Hierarchien zwischen Zuständen zu definieren. Dies bietet den Vorteil eine bessere Übersicht über die Zustände zu haben, vor allem bei komplexen NPC. \autocite{AIgames}


\subsection{Behavior Trees}

BT sind in den Vordergrund der Game-AI gerückt. So bieten sie einen intuitiveren Ansatz als frühere Techniken wie FSM, die oft komplexe Datenstrukturen erforderten die bei einer Vergrößerung einen schlecht strukturierten Code erzeugen \autocite{qlbt}. Im Kapitel wurden bereits die Videospiele \textit{Alien Isolation (2014)} und \textit{The Last of Us (2013)} als erfolgreiche Titel in Richtung Game-AI beschrieben. Beide Titel setzen den BT als Entscheidungssystem um. Der BT wurde mit dem Videospiel Titel \textit{Halo 2 (2004)} eingeführt.

Schaut man sich Studien bezüglich Entscheidungssysteme an, so kann man den Behavior Tree als Trend erkennen. So besitzt das BT-System aktuellere Studien, auch außerhalb der Videospielentwicklung wie \autocite{btuav} und \autocite{8963263}. Studien, wie \autocite{rbt} und \autocite{qlbt}, beschäftigen sich mit dem Einsatz des maschinellen Lernens, um einen Behavior Tree zu optimalisieren. So kann das {QL-BT} System \autocite{qlbt} mittels RL ein BT optimalisiert werden, indem es die Knoten eines Baumes reorganisiert. Das System soll unter anderem ein BT simplifizieren und Code Duplikationen reduzieren.


\subsection{GOAP}

Im Vergleich zu Behavior Trees ist der Forschungsstand zu GOAP im Bereich der Game-AI weniger umfangreich. Dennoch existieren Studien, die Ansätze zur Nutzung von GOAP beschreiben. So wurde in \autocite{Schwab2021} eine Methode beschrieben, die mittels GOAP ein Behavior Tree konstruiert. Da das manuelle Erstellen von BTs eine aufwendige und stark parameterabhängige Aufgabe darstellt, bietet die automatische Konstruktion eine Alternative. Diese Methode beobachtet zunächst das Verhalten, das GOAP in einer Monte-Carlo-Simulation zeigt, und nutzt anschließend einen genetischen Algorithmus, um einen geeigneten Behavior Tree zu entwickeln. Die resultierenden Behavior Trees zeichnen sich dadurch aus, dass sie verständlich, anpassbar und ebenso leistungsfähig wie manuell erstellte Modelle sind. \autocite{Schwab2021}

Im Bereich der Videospielentwicklung scheint das GOAP System in den Hintergrund gerückt zu sein. Das letzte bekannte Videospiel, welches GOAP umgesetzt hat war \textit{Deus Ex: human revolution (2011)}. Derzeit gibt es einen Mangel an Bibliotheken, die auch unabhängigen Videospielentwicklern zur Verfügung stehen und GOAP Systeme beinhalten. Studien wie \autocite{sielicki2018adaptation} fordern mehr Bibliotheken in Richtung \textit{Goal oriented action planning} Systeme. So hat die Studie selbst das GOAP System in der Game-Engine \textit{Unreal Engine} umgesetzt.


\begin{sidewaystable}[h]
  \label{Videospiele und ihre Entscheidungssysteme}
  \renewcommand{\arraystretch}{1.2}
  \centering
  \small
    \begin{tabularx}{0.95\textwidth}{l l x x x x}
			\toprule
      \textbf{Videospiel} & \textbf{Entscheidungssystem} & \textbf{Genre} & \textbf{Entwicklerstudio} & \textbf{Erscheinungsjahr} & \textbf{Quelle} \\
			\toprule
			Driver: San Francisco & BT & Rennspiel & Ubisoft & 2011 & \autocite{Ocio2021} \\
      Spore & BT & Strategie & Maxis & 2008 & \autocite{spore} \\
      Halo 2 & BT & FPS & Bungie & 2004 & \autocite{aiag} \\
      Tomb Raider & GOAP & Action & Eidos Montreal & 2013 & \autocite{goap_gdc} \\
      Half-Life & FSM & FPS & Valve & 1998 & \autocite{halflife} \\
      S.T.A.L.K.E.R.: Shadow of Chernobyl & GOAP & FPS & GSC Game World & 2007 & \autocite{sielicki2018adaptation} \\
      No One Lives Forever 2 & FSM & FPS & Monolith Productions & 2002 & \autocite{fear} \\
      F.E.A.R & GOAP & FPS & Monolith Productions & 2005 & \autocite{fear} \\
      Deus Ex: Human Revolution & GOAP & FPS & Eidos Montreal & 2011 & \autocite{sielicki2018adaptation} \\
      Middle-earth: Shadow of Mordor & GOAP & Rollenspiel & Monolith Productions & 2014 & \autocite{goap_gdc} \\
      Alien: Isolation & BT & FPS & Creative Assembly & 2014 & \autocite{vsvelch2020should} \\
      The Last of Us & BT & TPS & Naughty Dog & 2013 & \autocite{panwar2022npcaiuscase} \\
      Mafia III & BT & TPS & 2K Games & 2016 & \autocite{holba2021open} \\
      \bottomrule
    \end{tabularx}
		\caption{Videospiele der letzten Jahre und ihre Entscheidungssysteme}
\end{sidewaystable}
%S.W.A.T. 4&GOAP&FPS&Irrational Games&2005&&

